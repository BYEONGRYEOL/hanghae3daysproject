<!DOCTYPE html>
<html>
<head>
    <title>주문 정보</title>
</head>
<body>
    <h1>주문 정보</h1>
    <ul>
        {% for cart in data['cart_list'] %}
        <li>
            <h2>가게 ID: {{ cart.shop_id }}</h2>
            <p>가게 이름: {{ cart.shop_name }}</p>
            <h2>음식 정보</h2>
            <ul>
                {% for food in cart.food %}
                <li>
                    <p>음식 ID: {{ food.id }}</p>
                    <label for="food_name{{ food.id }}">음식 이름:</label>
                    <input type="text" id="food_name{{ food.id }}" name="food_name{{ food.id }}" value="{{ food.food_name }}" readonly><br><br>
            
                    <label for="food_price{{ food.id }}">음식 가격:</label>
                    <input type="text" id="food_price{{ food.id }}" name="food_price{{ food.id }}" value="{{ food.food_price }}" readonly><br><br>
            
                    <label for="food_count{{ food.id }}">수량:</label>
                    <input type="text" id="food_count{{ food.id }}" name="food_count{{ food.id }}" value="{{ food.food_count}}" readonly><br><br>
                </li>
                {% endfor %}
            </ul>
        </li>
        {% endfor %}
    </ul>
    <!-- 총 가격을 나타내는 total_price 추가 -->
    <p>총 가격: {{ data["total_price"] }}</p>
    <button type="button" id="submitOrderButton">주문하기</button>
    <script>
        document.getElementById("submitOrderButton").addEventListener("click", function() {
            // 데이터를 서버에 POST
            var formData = {
                cart_list: {{ data['cart_list'] | tojson }},  // Python dict를 JSON 문자열로 변환
                total_price: {{ data['total_price'] }}
            };
            console.log('form_date : ', formData);
            fetch('/order', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData),  // JSON 데이터를 서버로 전송
            }).then(response => {
                return response.text();
            }).then(data => {
                console.log(data);  // 서버에서 받은 응답 메시지 표시
                // window.location.href = '/order/list'; TODO: 주문목록으로 이동하기.
            });
        });
    </script>
</body>
</html>

